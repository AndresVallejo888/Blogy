<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel de Administrador - Blogy</title>
    <link rel="stylesheet" href="styles/dashboard-admin.css">
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const response = await fetch('/api/usuario-actual');
                if (response.ok) {
                    const user = await response.json();
                    if (!user.isAdmin) {
                        window.location.href = '/front/login-admin.html';
                    }
                    document.getElementById('userName').textContent = `${user.nombre} ${user.apellido}`;
                    document.getElementById('userEmail').textContent = user.email;
                } else {
                    window.location.href = '/front/login-admin.html';
                }
            } catch (error) {
                console.error('Error verificando sesión:', error);
                window.location.href = '/front/login-admin.html';
            }
        });

        function toggleUserPanel() {
            const panel = document.getElementById('userPanel');
            panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
        }

        async function logout() {
            try {
                await fetch('/logout', { method: 'GET' });
                window.location.href = '/front/login-admin.html';
            } catch (error) {
                console.error('Error al cerrar sesión:', error);
            }
        }
    </script>
</head>
<body>
    <div class="header">BLOGY - Administrador</div>
    
    <div class="user-toggle" onclick="toggleUserPanel()">
        <img src="images/user.png" alt="Usuario">
    </div>

    <div id="userPanel" class="user-panel">
        <strong id="userName">Cargando...</strong>
        <small id="userEmail">cargando@correo.com</small>
        <a href="#" class="logout-btn" onclick="logout()">Cerrar Sesión</a>
    </div>

    <h1>¿Qué desea hacer?</h1>

    <div class="card-container">
        <div class="card">
            <img src="images/editar.png" alt="Editar/Eliminar">
            <h2>Manejar Blogs</h2>
            <a href="/front/manejarBlogs.html">Haz click aquí</a>
        </div>

        <div class="card">
            <img src="images/solicitudes.png" alt="Solicitudes">
            <h2>Solicitudes</h2>
            <a href="/front/solicitudes.html">Haz click aquí</a>
        </div>

        <div class="card">
            <img src="images/reportes.png" alt="Ver Reportes">
            <h2>Ver Reportes</h2>
            <a href="/front/reportes.html">Haz click aquí</a>
        </div>
    </div>
</body>
</html>